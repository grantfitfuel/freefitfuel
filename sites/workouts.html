<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Workouts ‚Äì FreeFitFuel</title>

  <link rel="stylesheet" href="style.css?v=23">
  <link rel="icon" type="image/svg+xml" href="img/freefitfuel-logo.svg">

  <style>
    /* Page-only styling (kept your structure) */
    .wrap{max-width:var(--maxw);margin:0 auto;padding:18px 20px}
    .lead{color:var(--inkdim)}

    /* HERO (unchanged layout) */
    .hero-mini{position:relative;border-bottom:1px solid #1b1b22}
    .hero-mini figure{margin:0;position:relative}
    .hero-mini img{width:100%;height:46vh;min-height:320px;object-fit:cover;display:block;filter:brightness(.88) saturate(1.05)}
    .hero-mini .overlay{position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,.45),rgba(0,0,0,.65))}
    .hero-mini .content{position:absolute;inset:auto 0 0 0;padding:16px 20px 22px;max-width:var(--maxw);margin:0 auto}
    .hero-mini h1{margin:0 0 .35rem}
    .hero-mini p{max-width:70ch;margin:.2rem 0 0;color:#d0d0da}
    .hero-media .overlay {
  background: none !important;
}

    /* Toolbar with goals & equipment */
    .toolbar{display:flex;flex-wrap:wrap;gap:.6rem;align-items:center;margin:1rem 0 1.1rem}
    .seg{display:inline-flex;border:1px solid var(--stroke);border-radius:999px;overflow:hidden}
    .seg button{background:var(--glass);color:var(--ink);border:0;padding:.45rem .85rem;cursor:pointer}
    .seg button[aria-pressed="true"]{background:var(--accent);color:#111;font-weight:800}

    .equip{display:flex;align-items:center;gap:.45rem;flex-wrap:wrap;margin-left:auto}
    .equip .label{opacity:.9}
    .pill{display:inline-flex;align-items:center;gap:.35rem;background:var(--glass);border:1px solid var(--stroke);border-radius:999px;padding:.35rem .65rem;font-size:.92rem}
    .pill input{accent-color:var(--accent)}

    /* Smaller goal explainers on mobile */
    .goals-note{color:var(--inkdim);margin-top:-.35rem}
    @media (max-width: 820px){
      .goals-note{font-size:.9rem;opacity:.9}
      .equip{width:100%;margin:0}
      .equip .label{width:100%;margin-bottom:.2rem}
    }

    /* Sections & blocks */
    .section{background:var(--glass);border:1px solid var(--stroke);border-radius:14px;margin:12px 0;padding:14px}
    .section>h2{margin:.15rem 0 .45rem;font-size:1.2rem}
    .plan{display:grid;gap:12px}
    @media (min-width:780px){.plan{grid-template-columns:repeat(2,1fr)}}
    .block{background:#111418;border:1px solid var(--stroke);border-radius:12px;padding:12px}
    .block h3{margin:.1rem 0 .35rem;font-size:1.05rem}
    .mov{display:flex;justify-content:space-between;gap:.6rem;padding:.45rem .55rem;border:1px dashed var(--stroke);border-radius:8px;margin:.35rem 0}
    .mov .name{font-weight:600}
    .mov .rx{opacity:.85}

    /* Cards / library */
    .grid{display:grid;gap:14px}
    @media (min-width:900px){.grid{grid-template-columns:repeat(3,1fr)}}
    .card{background:#111418;border:1px solid var(--stroke);border-radius:12px;overflow:hidden}
    .card h4{margin:.7rem .9rem .35rem}
    .badge{
      display:inline-block; margin-left:.35rem; padding:.1rem .45rem;
      border:1px solid var(--stroke); border-radius:999px; font-size:.78rem;
      background:rgba(255,255,255,.08); color:var(--ink);
    }

    .tile{position:relative;aspect-ratio:16/9;background:#000;overflow:hidden;border-radius:8px}
    .tile button.play{position:absolute;inset:0;display:grid;place-items:center;border:0;background:transparent;cursor:pointer}
    .tile .thumb{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;filter:brightness(.88)}
    .tile iframe{position:absolute;inset:0;width:100%;height:100%;border:0;display:none}

    .tile .openers{position:absolute;right:.45rem;bottom:.45rem;display:flex;gap:.35rem;z-index:2}
    .tile .openers a{background:rgba(0,0,0,.65);color:#fff;border:1px solid rgba(255,255,255,.25);font-size:.8rem;padding:.25rem .45rem;border-radius:6px;text-decoration:none}

    .tags{display:flex;flex-wrap:wrap;gap:.35rem;margin:.45rem .9rem .6rem}
    .tag{background:rgba(255,255,255,.08);border:1px solid var(--stroke);border-radius:999px;padding:.18rem .55rem;font-size:.82rem}

    .anatomy{display:flex;align-items:center;gap:.5rem;padding:.5rem .9rem .85rem}
    .anatomy img{width:92px;height:auto;border-radius:8px;border:1px solid var(--stroke);background:#0b0f14}

    /* Timers */
    .timer{display:flex;gap:.4rem;align-items:center;margin-top:.5rem}
    .timer input{width:84px;background:#0b0f14;border:1px solid var(--stroke);border-radius:6px;color:var(--ink);padding:.35rem .45rem}
    .timer button{border:1px solid var(--stroke);background:var(--glass);color:var(--ink);padding:.35rem .6rem;border-radius:8px;cursor:pointer}
    .timer .left{min-width:60px;text-align:right;opacity:.85}

    /* Shared collapsible panels */
    .details{background:#0e1217;border:1px solid var(--stroke);border-radius:10px;padding:.55rem .7rem;margin:.5rem 0}
    .details summary{cursor:pointer;font-weight:600}
    .details p,.details ul,.details ol{margin:.35rem 0}

    /* Compact demo grid inside standards */
    .mini-grid{display:grid;gap:.6rem;margin-top:.5rem}
    @media (min-width:700px){.mini-grid{grid-template-columns:repeat(3,1fr)}}
    .demo-caption{font-size:.86rem;color:var(--inkdim);margin:.25rem 0 0 .15rem}

    /* Minor helper */
    .info{color:var(--inkdim);margin:.35rem 0 .2rem}
  </style>
</head>
<body>

<!-- Shared header mount -->
<div id="site-header"></div>
<script src="/js/header-loader.js"></script>

<!-- HERO -->
<header class="hero-mini" role="banner" aria-label="Workouts hero">
  <figure>
    <img src="img/curl.jpg" alt="dumbbell curl">
    <div class="overlay" aria-hidden="true"></div>
  </figure>
  <div class="content wrap">
    <h1><span class="accent">Workouts that fit life</span></h1>
    <p>Clear plans, video form, anatomy diagrams, and audible timers. Train smart at home with dumbbells, bands, or bodyweight.</p>
  </div>
</header>

<main class="wrap">
  <p class="lead">Pick your <strong>difficulty</strong>, <strong>goal</strong> and <strong>equipment</strong>. Plans update instantly. Tap a tile to play the clip. If a video is blocked, use ‚ÄúOpen on YouTube‚Äù or ‚ÄúSearch‚Äù.</p>

  <!-- Global controls -->
  <div class="toolbar" aria-label="Workout controls">
    <!-- Difficulty -->
    <div class="seg" role="tablist" aria-label="Difficulty">
      <button role="tab" aria-pressed="true" data-level="beginner">Beginner</button>
      <button role="tab" aria-pressed="false" data-level="intermediate">Intermediate</button>
      <button role="tab" aria-pressed="false" data-level="advanced">Advanced</button>
    </div>

    <!-- Goals -->
    <div class="seg" role="tablist" aria-label="Goal" style="margin-left:.5rem">
      <button role="tab" aria-pressed="true" data-goal="maintain">Maintain</button>
      <button role="tab" aria-pressed="false" data-goal="cut">Cut</button>
      <button role="tab" aria-pressed="false" data-goal="build">Build</button>
      <button role="tab" aria-pressed="false" data-goal="transform">Transform</button>
    </div>
  </div>

  <p class="goals-note">
    <strong>Maintain:</strong> keep strength/fitness steady ¬∑
    <strong>Cut:</strong> higher reps/shorter rests to support fat loss ¬∑
    <strong>Build (Bulk):</strong> moderate reps; add load or sets over weeks ¬∑
    <strong>Transform:</strong> mixed strength/conditioning ‚Äî challenging but scalable.
  </p>

  <!-- Equipment -->
  <div class="toolbar equip" aria-label="Equipment filters">
    <span class="label">Equipment:</span>
    <span class="pill"><input type="checkbox" id="f-db" checked> <label for="f-db">Dumbbells</label></span>
    <span class="pill"><input type="checkbox" id="f-band" checked> <label for="f-band">Bands</label></span>
    <span class="pill"><input type="checkbox" id="f-bw" checked> <label for="f-bw">Bodyweight</label></span>
    <span class="pill"><input type="checkbox" id="f-rack"> <label for="f-rack">Bar / Door anchor</label></span>
    <span class="pill"><input type="checkbox" id="f-rings"> <label for="f-rings">Rings</label></span>
  </div>

  <!-- Weekly split -->
  <div class="section">
    <h2>Weekly Split</h2>
    <div class="plan" id="plan"></div>
    <p class="meta">Short on time? Do the <strong>Full-Body</strong> day 2‚Äì3√ó/week with a walk or mobility between.</p>
  </div>

  <!-- Calisthenics -->
  <div class="section">
    <h2>Calisthenics Progressions</h2>
    <p class="info">Simple bodyweight progressions that build tendon strength, control and balance. Move up when all reps are clean with full range.</p>
    <div class="plan" id="cal"></div>
    <p class="meta">Start comfortably; progress when all reps are clean with full range.</p>
  </div>

  <!-- Cross-Training Benchmarks -->
  <div class="section" id="xfit-section">
    <h2>Cross-Training Benchmarks üèãÔ∏è‚Äç‚ôÄÔ∏è <span class="meta" style="font-weight:normal">(colloquially known as ‚ÄúCindy‚Äù, ‚ÄúChelsea‚Äù, ‚ÄúAnnie‚Äù)</span></h2>
    <p class="meta">These are community-famous benchmark formats. <strong>CrossFit¬Æ is a registered trademark of CrossFit, LLC.</strong> FreeFitFuel is not affiliated with, endorsed, or sponsored by CrossFit, LLC.</p>
    <div class="plan" id="xfit"></div>
    <p class="meta">Choose a level, set the timer on each card, and log total rounds, splits, or time to complete.</p>
  </div>

  <!-- Library -->
  <div class="section" id="library">
    <h2>Form Library (watch & copy)</h2>
    <div class="grid" id="lib"></div>
  </div>

  <!-- Disclaimer (standard) -->
  <section class="section">
    <h2>Important Note</h2>
    <p>The content on FreeFitFuel is for general fitness education only and isn‚Äôt a substitute for personalised medical advice. Consult a qualified professional before starting a new programme, especially if you have any health conditions or injuries. Stop any exercise that causes sharp pain, dizziness, chest pain, or unusual shortness of breath.</p>
  </section>
</main>

<footer class="site-footer">
  <div class="container">
    <img src="img/freefitfuel-logo.svg" alt="FreeFitFuel Logo" height="64">
    <p>¬© 2025 FreeFitFuel ¬∑ All rights reserved.</p>
    <p class="credit">Created by Grant Cameron Anthony</p>
  </div>
</footer>

<!-- JS -->
<script>
/* ===== Header burger ===== */
document.addEventListener('DOMContentLoaded', () => {
  const btn = document.querySelector('.hamburger');
  const nav = document.querySelector('.main-nav');
  if(btn && nav){
    btn.addEventListener('click', () => {
      const open = btn.classList.toggle('active');
      nav.classList.toggle('open', open);
      btn.setAttribute('aria-expanded', open ? 'true' : 'false');
    });
  }
});

/* ===== Form Library DATA (unchanged core set) ===== */
const EX = [
  /* ---------- PUSH ---------- */
  {k:'pushup',  n:'Push-up',                cat:'push',  eq:'bw',    yt:'IODxDxX7oi4', muscles:['muscles-front-chest-pecs','muscles-back-triceps-long','muscles-front-deltoids-front']},
  {k:'dbfloor', n:'DB Floor Press',         cat:'push',  eq:'db',    yt:'uUGDRwge4F8', muscles:['muscles-front-chest-pecs','muscles-back-triceps-long','muscles-front-deltoids-front']},
  {k:'dbbench', n:'DB Bench Press',         cat:'push',  eq:'db',    yt:'VmB1G1K7v94', muscles:['muscles-front-chest-pecs','muscles-back-triceps-long','muscles-front-deltoids-front']},
  {k:'arnold',  n:'Arnold Press',           cat:'push',  eq:'db',    yt:'3ml7BH7mNwQ', muscles:['muscles-front-deltoids-front','muscles-front-deltoids-mid','muscles-back-deltoids-rear']},
  {k:'latraise',n:'Lateral Raise',          cat:'push',  eq:'db',    yt:'3VcKaXpzqRo', muscles:['muscles-front-deltoids-mid']},
  {k:'thruster',n:'DB Thruster',            cat:'push',  eq:'db',    yt:'mtbZQsHwauI', muscles:['muscles-front-quads-rectus','muscles-back-glutes-maximus','muscles-front-deltoids-front']},

  /* ---------- PULL ---------- */
  {k:'bandrow', n:'Band Row',               cat:'pull',  eq:'band',  yt:'aA2yvYz6xs8', muscles:['muscles-back-lats-upper','muscles-back-rhomboids','muscles-back-deltoids-rear']},
  {k:'doorrow', n:'Doorway Row',            cat:'pull',  eq:'bw',    yt:'r8NzhNe9Res', muscles:['muscles-back-lats-mid','muscles-back-rhomboids','muscles-back-deltoids-rear']},
  {k:'bandlat', n:'Band Lat Pulldown',      cat:'pull',  eq:'band',  yt:'f4ZkQem6FGo', muscles:['muscles-back-lats-lower','muscles-back-lats-upper','muscles-front-biceps-long']},
  {k:'anchorpd',n:'Door Anchor Pull-down',  cat:'pull',  eq:'rack',  yt:'h2f_v6v3OQI', muscles:['muscles-back-lats-lower','muscles-front-biceps-long','muscles-back-traps-mid']},
  {k:'chin',    n:'Chin-up (band assist)',  cat:'pull',  eq:'rack',  yt:'z9x2rYc4qYI', muscles:['muscles-back-lats-upper','muscles-front-biceps-long','muscles-back-traps-mid'], badges:['Bar']},
  {k:'csrow',   n:'Chest-Supported DB Row', cat:'pull',  eq:'db',    yt:'wzj8gBqGxF4', muscles:['muscles-back-lats-mid','muscles-back-rhomboids','muscles-back-deltoids-rear']},
  {k:'renrow',  n:'Renegade Row',           cat:'pull',  eq:'db',    yt:'R5rj8m9r-1g', muscles:['muscles-back-lats-mid','muscles-front-obliques-external','muscles-front-abs-upper']},
  {k:'zott',    n:'Zottman Curl',           cat:'pull',  eq:'db',    yt:'l0gDqsSUtWo', muscles:['muscles-front-biceps-long','muscles-front-forearms-flexors','muscles-back-forearms-extensors']},

  /* ---------- LEGS / CORE ---------- */
  {k:'stepup',  n:'Step-up',                cat:'legs',  eq:'db',    yt:'yQ0Z5zq2mTw', muscles:['muscles-front-quads-rectus','muscles-back-glutes-maximus','muscles-back-hamstrings-biceps-femoris']},
  {k:'dbrdl',   n:'DB Romanian Deadlift',   cat:'legs',  eq:'db',    yt:'2SHsk9AzdjA', muscles:['muscles-back-hamstrings-biceps-femoris','muscles-back-glutes-maximus','muscles-back-erector-spinae']},
  {k:'sidepl',  n:'Side Plank',             cat:'legs',  eq:'bw',    yt:'K2VljzCC16g', muscles:['muscles-front-obliques-external','muscles-front-abs-lower']},

  /* ---------- FULL BODY ---------- */
  {k:'manmaker',n:'Man Maker',              cat:'full',  eq:'db',    yt:'wV2bF1X8Y4M', muscles:['muscles-front-abs-upper','muscles-front-deltoids-front','muscles-back-lats-upper']},
  {k:'dbcp',    n:'DB Clean & Press',       cat:'full',  eq:'db',    yt:'zQ6ZlJkFQ3E', muscles:['muscles-front-deltoids-front','muscles-back-glutes-maximus','muscles-front-quads-rectus']},
  {k:'hswall',  n:'Wall Handstand (beginner)',cat:'full',eq:'bw',    yt:'tZyq3x1y9mQ', muscles:['muscles-front-deltoids-front','muscles-back-triceps-long','muscles-back-traps-upper']}
];

/* Weekly prescriptions */
const RX = {
  push:{
    beginner:[{k:'pushup',rx:'3√ó6‚Äì10'},{k:'dbfloor',rx:'3√ó8‚Äì12'},{k:'latraise',rx:'3√ó12‚Äì15',opt:true},{k:'sidepl',rx:'2√ó25‚Äì40s',opt:true}],
    intermediate:[{k:'dbbench',rx:'4√ó6‚Äì10'},{k:'arnold',rx:'4√ó8‚Äì12'},{k:'latraise',rx:'3√ó12‚Äì15'},{k:'thruster',rx:'3√ó8‚Äì12',finisher:true}],
    advanced:[{k:'dbbench',rx:'5√ó5‚Äì8'},{k:'arnold',rx:'5√ó6‚Äì10'},{k:'latraise',rx:'4√ó12‚Äì15'},{k:'thruster',rx:'4√ó10‚Äì12'}]
  },
  pull:{
    beginner:[{k:'bandrow',rx:'3√ó10‚Äì12'},{k:'zott',rx:'3√ó10‚Äì12'}],
    intermediate:[{k:'doorrow',rx:'4√ó8‚Äì12'},{k:'csrow',rx:'4√ó8‚Äì12'},{k:'zott',rx:'3√ó10‚Äì12'}],
    advanced:[{k:'chin',rx:'5√óAMRAP'},{k:'csrow',rx:'5√ó6‚Äì10'},{k:'renrow',rx:'4√ó8‚Äì12'}]
  },
  legs:{
    beginner:[{k:'stepup',rx:'3√ó8‚Äì12'},{k:'dbrdl',rx:'3√ó8‚Äì12'},{k:'sidepl',rx:'2√ó25‚Äì40s'}],
    intermediate:[{k:'stepup',rx:'4√ó8‚Äì12'},{k:'dbrdl',rx:'4√ó6‚Äì10'},{k:'sidepl',rx:'3√ó30‚Äì45s'}],
    advanced:[{k:'stepup',rx:'5√ó8‚Äì12'},{k:'dbrdl',rx:'5√ó6‚Äì8'},{k:'thruster',rx:'4√ó10‚Äì12'}]
  },
  full:{
    beginner:[{k:'pushup',rx:'3√ó6‚Äì10'},{k:'bandrow',rx:'3√ó10‚Äì12'},{k:'stepup',rx:'3√ó8‚Äì12'},{k:'sidepl',rx:'2√ó25‚Äì40s'}],
    intermediate:[{k:'dbbench',rx:'4√ó6‚Äì10'},{k:'csrow',rx:'4√ó8‚Äì12'},{k:'dbrdl',rx:'4√ó8‚Äì12'},{k:'dbcp',rx:'3√ó6‚Äì8'}],
    advanced:[{k:'dbcp',rx:'5√ó3‚Äì5'},{k:'dbbench',rx:'5√ó5‚Äì8'},{k:'csrow',rx:'5√ó6‚Äì10'},{k:'manmaker',rx:'4√ó8‚Äì10'}]
  }
};

/* ===== Calisthenics with explicit sessions for Core & Legs ===== */
const CAL = [
  {title:'Push', items:[
    {k:'pushup',  rxB:'Incline push-up 3√ó8‚Äì12', rxI:'Flat push-up 4√ó8‚Äì12', rxA:'Feet-elevated / ring push-up 5√ó6‚Äì10'},
    {k:'dipbench',rxB:'Bench dip 3√ó8‚Äì12',       rxI:'Feet-elevated dip 4√ó8‚Äì12', rxA:'Parallel bar dip 5√ó6‚Äì10'}
  ]},
  {title:'Pull', items:[
    {k:'doorrow', rxB:'Table/door row 3√ó8‚Äì12',  rxI:'Feet-elevated row 4√ó8‚Äì12', rxA:'Chin-up 5√óAMRAP'}
  ]},

  /* ---------- CORE with ‚ÄúAbout‚Äù + Suggested Sessions ---------- */
  {title:'Core', about:{
      why:[
        'Strong trunk protects the spine and transfers force between upper and lower body.'
      ],
      cues:[
        'Ribs down, light brace; breathe behind the brace.',
        'Neutral pelvis; avoid over-arching or tucking.'
      ],
      faults:[
        'Holding breath hard on every rep; flared ribs; neck pulling on sit-ups.'
      ],
      progress:[
        'Hollow: tuck ‚Üí full hold ‚Üí rocks. L-sit: tuck ‚Üí one-leg ‚Üí full.'
      ],
      safety:[
        'If you feel back pain, shorten the lever and re-brace; add time in 5‚Äì10s steps.'
      ],
      prep:[
        '2‚Äì3 rounds: cat‚Äìcow √ó8, dead bug √ó6/side, glute bridge (2s pause) √ó8.'
      ]
    },
    items:[
      {k:'hollow',  rxB:'Hollow tuck 3√ó20‚Äì30s',   rxI:'Hollow body 4√ó20‚Äì40s',     rxA:'Hollow + rocks 4√ó30‚Äì45s'},
      {k:'lsit',    rxB:'Tuck L-sit 6√ó10‚Äì15s',    rxI:'One-leg L-sit 6√ó10‚Äì15s',   rxA:'Full L-sit 6√ó10‚Äì20s'}
    ],
    sessions:{
      beginner:[
        'Prep circuit (2 rounds): cat‚Äìcow √ó8 ¬∑ dead bug √ó6/side ¬∑ glute bridge (2s hold) √ó8',
        'Hollow tuck ‚Äî 3√ó20‚Äì30s ¬∑ rest 30‚Äì45s',
        'Side plank ‚Äî 2√ó25‚Äì40s/side ¬∑ rest 20‚Äì30s between sides',
        'Tuck L-sit (on boxes or parallettes) ‚Äî accumulate 60‚Äì90s total in small sets',
        'Finisher: dead bug ‚Äî 2√ó6/side slow'
      ],
      intermediate:[
        'Prep circuit (2 rounds): cat‚Äìcow √ó8 ¬∑ dead bug √ó6/side ¬∑ glute bridge (2s hold) √ó10',
        'Hollow body ‚Äî 4√ó20‚Äì40s ¬∑ rest 30‚Äì45s',
        'One-leg L-sit ‚Äî 6√ó10‚Äì15s alternating legs ¬∑ rest 20‚Äì30s',
        'Side plank ‚Äî 3√ó30‚Äì45s/side ¬∑ rest 30s',
        'Optional: slow cross-body mountain climber ‚Äî 2√ó20 total'
      ],
      advanced:[
        'Prep (2 rounds): segmental cat‚Äìcow √ó6 ¬∑ dead bug iso holds √ó5/side',
        'Hollow rocks ‚Äî 4√ó30‚Äì45s ¬∑ rest 45‚Äì60s',
        'Full L-sit ‚Äî 6√ó10‚Äì20s ¬∑ rest 30‚Äì45s',
        'Long-lever side plank or star plank ‚Äî 3√ó20‚Äì30s/side',
        'Optional: strict toes-to-bar negatives ‚Äî 3√ó3 slow'
      ]
    }
  },

  /* ---------- LEGS with ‚ÄúAbout‚Äù + Suggested Sessions ---------- */
  {title:'Legs', about:{
      why:[
        'Single-leg strength improves balance, joint control and everyday movement.'
      ],
      cues:[
        'Foot tripod: big toe, little toe, heel pressed evenly.',
        'Knee tracks over 2nd‚Äì3rd toe; chest tall; control the lower for 2‚Äì3s.'
      ],
      faults:[
        'Knee valgus (caving), bouncing off the box, heels lifting.'
      ],
      progress:[
        'Box pistol ‚Üí assisted pistol ‚Üí full pistol; add tempo/pauses before load.'
      ],
      safety:[
        'No knee pain: raise the box, shorten the range, slow the tempo if needed.'
      ],
      prep:[
        '2 rounds: ankle rocks √ó10/side, supported hip airplane √ó5/side, calf raises √ó12.'
      ]
    },
    items:[
      {k:'pistol',  rxB:'Box pistol 3√ó6‚Äì10/leg',  rxI:'Assisted pistol 4√ó6‚Äì10',   rxA:'Pistol 5√ó5‚Äì8'}
    ],
    sessions:{
      beginner:[
        'Prep (2 rounds): ankle rocks √ó10/side ¬∑ hip airplane (supported) √ó5/side ¬∑ calf raises √ó12',
        'Box pistol to target ‚Äî 3√ó6‚Äì10/leg @ 3‚Äì1‚Äì1‚Äì0 tempo ¬∑ rest 45‚Äì60s',
        'Step-up (knee-height) ‚Äî 2√ó10/leg controlled ¬∑ rest 30‚Äì45s',
        'Calf raises ‚Äî 2√ó12 slow with 1‚Äì2s top pause'
      ],
      intermediate:[
        'Prep (2 rounds): ankle rocks √ó12/side ¬∑ hip airplane √ó6/side ¬∑ calf raises √ó15',
        'Assisted pistol ‚Äî 4√ó6‚Äì10/leg @ 3‚Äì1‚Äì1‚Äì0 ¬∑ rest 60‚Äì90s',
        'Split squat ‚Äî 3√ó8‚Äì12/leg (last 2 reps close to failure) ¬∑ rest 60s',
        'Cossack squat (mobility) ‚Äî 2√ó6/side smooth'
      ],
      advanced:[
        'Prep (2 rounds): deep calf pulses √ó15 ¬∑ hip airplane √ó6/side',
        'Full pistol ‚Äî 5√ó5‚Äì8/leg @ 3‚Äì1‚Äì1‚Äì0 ¬∑ rest 90s',
        'Bulgarian split squat ‚Äî 3√ó8‚Äì10/leg ¬∑ rest 60‚Äì90s',
        'Optional power: low box jump ‚Äî 3√ó8 crisp reps ¬∑ full control'
      ]
    }
  },

  {title:'Skills', items:[
    {k:'hswall',  rxB:'Wall handstand hold 5√ó20‚Äì30s', rxI:'Wall shoulder taps 4√ó10/side', rxA:'Freestanding attempts 8‚Äì10√ó15s'}
  ]}
];

/* ===== Cross-Training Benchmarks (Cindy / Chelsea / Annie styles) ===== */
const XWODS = [
  {
    code:'amrap-20-5-10-15',
    title:'AMRAP 20: Pull ‚Ä¢ Push ‚Ä¢ Squat',
    aka:'(aka ‚ÄúCindy‚Äù format)',
    rx:{
      beginner:'20:00 AMRAP ‚Äî 3 Rows ‚Ä¢ 6 Incline Push-ups ‚Ä¢ 10 Air Squats',
      intermediate:'20:00 AMRAP ‚Äî 5 Pull-ups (or rows) ‚Ä¢ 10 Push-ups ‚Ä¢ 15 Air Squats',
      advanced:'20:00 AMRAP ‚Äî 5 Strict Pull-ups ‚Ä¢ 10 Push-ups ‚Ä¢ 15 Air Squats'
    },
    notes:'Score = total completed rounds + extra reps. Pace so first 5 min ‚âà last 5.',
    presets:{seconds:1200},
    demos:[
      {title:'Pull-up / Row (scales)', yt:'r8NzhNe9Res'},
      {title:'Push-up (standards)', yt:'IODxDxX7oi4'},
      {title:'Air Squat (standards)', yt:'UXJrBgI2RxA'}
    ]
  },
  {
    code:'emom-30-5-10-15',
    title:'EMOM 30: Triplet Every Minute',
    aka:'(aka ‚ÄúChelsea‚Äù format)',
    rx:{
      beginner:'30:00 EMOM ‚Äî 3 Rows ‚Ä¢ 6 Incline Push-ups ‚Ä¢ 10 Air Squats (scale as needed)',
      intermediate:'30:00 EMOM ‚Äî 5 Pull-ups (or rows) ‚Ä¢ 10 Push-ups ‚Ä¢ 15 Air Squats',
      advanced:'30:00 EMOM ‚Äî 5 Pull-ups ‚Ä¢ 10 Push-ups ‚Ä¢ 15 Air Squats (hold for max unbroken minutes)'
    },
    notes:'If you miss a minute, reduce reps by ~20% or turn remaining time into AMRAP.',
    presets:{seconds:1800},
    demos:[
      {title:'Pull-up / Row (scales)', yt:'r8NzhNe9Res'},
      {title:'Push-up (standards)', yt:'IODxDxX7oi4'},
      {title:'Air Squat (standards)', yt:'UXJrBgI2RxA'}
    ]
  },
  {
    code:'for-time-50-40-30-20-10-du-situps',
    title:'For Time: Rope + Sit-up Ladder',
    aka:'(aka ‚ÄúAnnie‚Äù format)',
    rx:{
      beginner:'50-40-30-20-10 ‚Äî Single-unders & Sit-ups (or 40-30-20-10-10 to manage volume)',
      intermediate:'50-40-30-20-10 ‚Äî Single-unders (2:1) or DU attempts & Sit-ups',
      advanced:'50-40-30-20-10 ‚Äî Double-unders & Sit-ups'
    },
    notes:'Break jump-rope sets early; keep sit-ups smooth. Time cap: 12‚Äì15 min.',
    presets:{seconds:900},
    demos:[
      {title:'Double-Under', yt:'2gthFu0JFy4'},
      {title:'Sit-up (standards)', yt:'1fbU_MkV7NE'}
    ]
  }
];

/* ===== State ===== */
const planEl = document.getElementById('plan');
const calEl  = document.getElementById('cal');
const libEl  = document.getElementById('lib');
const xfitEl = document.getElementById('xfit');

let level = 'beginner';
let goal  = 'maintain';

/* Difficulty + Goal toggles */
document.querySelectorAll('.seg [data-level]').forEach(b=>{
  b.addEventListener('click', ()=>{
    document.querySelectorAll('.seg [data-level]').forEach(x=>x.setAttribute('aria-pressed','false'));
    b.setAttribute('aria-pressed','true');
    level = b.dataset.level;
    renderPlan(); renderCal(); renderXFit();
  });
});

document.querySelectorAll('.seg [data-goal]').forEach(b=>{
  b.addEventListener('click', ()=>{
    document.querySelectorAll('.seg [data-goal]').forEach(x=>x.setAttribute('aria-pressed','false'));
    b.setAttribute('aria-pressed','true');
    goal = b.dataset.goal;
    renderPlan(); renderCal(); renderXFit();
  });
});

/* Equipment filters */
function getFilters(){
  return {
    db: document.getElementById('f-db').checked,
    band: document.getElementById('f-band').checked,
    bw: document.getElementById('f-bw').checked,
    rack: document.getElementById('f-rack').checked,
    rings: document.getElementById('f-rings').checked
  };
}
['f-db','f-band','f-bw','f-rack','f-rings'].forEach(id=>{
  const el = document.getElementById(id);
  if(el) el.addEventListener('change', ()=>{ renderPlan(); renderCal(); renderLibrary(); });
});

/* ===== Helpers ===== */
function anatomy(ms){
  const imgs = ms.slice(0,3).map(m=>`<img src="img/anatomy/${m}.png" alt="${m} diagram" onerror="this.style.display='none'">`).join('');
  return `<div class="anatomy">${imgs}</div>`;
}
function timerHTML(id, preset=60){
  return `
  <div class="timer" data-timer="${id}">
    <label for="t-${id}" class="visually-hidden">Timer (seconds)</label>
    <input id="t-${id}" type="number" min="5" step="5" value="${preset}">
    <button data-act="start">Start</button>
    <button data-act="stop">Stop</button>
    <span class="left" aria-live="polite">${preset}s</span>
  </div>`;
}
function demoTileHTML(yt, title){
  const thumb = `https://img.youtube.com/vi/${yt}/hqdefault.jpg`;
  const safe = title.replace(/"/g,'&quot;');
  return `
    <div class="tile" data-yt="${yt}">
      <img class="thumb" src="${thumb}" alt="${safe} thumbnail" loading="lazy">
      <button class="play" aria-label="Play ${safe}">
        <svg width="60" height="60" viewBox="0 0 72 72" fill="none" aria-hidden="true">
          <circle cx="36" cy="36" r="34" stroke="white" stroke-opacity=".85" stroke-width="3"/>
          <polygon points="30,24 52,36 30,48" fill="white" />
        </svg>
      </button>
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              title="${safe} form video"></iframe>
    </div>
    <div class="demo-caption">${safe}</div>
  `;
}
function exByKey(k){ return EX.find(x=>x.k===k); }

/* Goal scaling: light touch (applies to Weekly Split & XFit rx text) */
function applyGoal(rxStr){
  if(goal==='cut')       return rxStr.replace(/(\d+)√ó/g,(m,n)=>(Math.max(2,+n+0))+'√ó') + ' ¬∑ 45‚Äì60s rest';
  if(goal==='build')     return rxStr.replace(/(\d+)√ó/g,(m,n)=>(Math.max(2,+n+1))+'√ó') + ' ¬∑ 60‚Äì90s rest';
  if(goal==='transform') return rxStr + ' + finisher';
  return rxStr;
}

/* Collapsible info block (matches Cross-Training style) */
function infoBlock(about, title='About'){
  if(!about) return '';
  const li = a => (a||[]).map(x=>`<li>${x}</li>`).join('');
  const safety = (about.safety||[]).join(' ');
  return `
    <details class="details">
      <summary>${title}: why, cues & safety</summary>
      <p><strong>Why it matters</strong></p><ul>${li(about.why)}</ul>
      <p><strong>Set-up & cues</strong></p><ul>${li(about.cues)}</ul>
      <p><strong>Common faults (fixes)</strong></p><ul>${li(about.faults)}</ul>
      <p><strong>Progression path</strong></p><ul>${li(about.progress)}</ul>
      <p><strong>Warm-up / prep</strong></p><ul>${li(about.prep)}</ul>
      <p class="meta">Safety: ${safety}</p>
    </details>
  `;
}

/* Render one level‚Äôs ordered session */
function sessionBlock(label, steps){
  if(!steps || !steps.length) return '';
  const lis = steps.map(s=>`<li>${s}</li>`).join('');
  return `
    <details class="details">
      <summary>${label} ‚Äî suggested session</summary>
      <ol>${lis}</ol>
    </details>
  `;
}

/* ===== Renderers ===== */
function renderPlan(){
  const f = getFilters(); 
  planEl.innerHTML='';
  ['push','pull','legs','full'].forEach(group=>{
    const blk = document.createElement('div'); blk.className='block';
    const title = group==='full'?'Full-Body Day Combination':
                  group==='legs'?'Legs Day ¬∑ Quads ‚Ä¢ Glutes ‚Ä¢ Hamstrings ‚Ä¢ Calves':
                  group[0].toUpperCase()+group.slice(1)+' Day';
    blk.innerHTML = `<h3>${title}</h3>`;
    const list = document.createElement('div');
    RX[group][level].forEach(it=>{
      const e = exByKey(it.k); if(!e) return;
      if(!f[e.eq]) return;
      if(e.eq==='rings' && !f.rings) return;
      const row = document.createElement('div'); row.className='mov';
      row.innerHTML = `<span class="name">${e.n}</span><span class="rx">${applyGoal(it.rx)}</span>`;
      list.appendChild(row);
    });
    blk.appendChild(list);
    blk.insertAdjacentHTML('beforeend', timerHTML('tm-'+group));
    planEl.appendChild(blk);
  });
  hookTimers();
}

/* Calisthenics render (with sessions for Core & Legs) */
function renderCal(){
  const f = getFilters(); 
  calEl.innerHTML='';
  CAL.forEach(col=>{
    const b = document.createElement('div'); 
    b.className='block';

    // Header + About
    b.innerHTML = `<h3>${col.title}</h3>${col.about ? infoBlock(col.about, col.title) : ''}`;

    // Level sessions (Core/Legs only)
    if(col.sessions){
      b.insertAdjacentHTML('beforeend', 
        sessionBlock('Beginner', col.sessions.beginner) +
        sessionBlock('Intermediate', col.sessions.intermediate) +
        sessionBlock('Advanced', col.sessions.advanced)
      );
    }

    // Progression rows
    col.items.forEach(it=>{
      const e = exByKey(it.k); if(!e) return;
      if(!f[e.eq]) return;
      const rx = level==='beginner'?it.rxB:level==='intermediate'?it.rxI:it.rxA;
      const row = document.createElement('div'); 
      row.className='mov';
      row.innerHTML = `<span class="name">${e.n}</span><span class="rx">${rx}</span>`;
      b.appendChild(row);
    });

    // Timer per block
    b.insertAdjacentHTML('beforeend', timerHTML('cal-'+col.title));
    calEl.appendChild(b);
  });
  hookTimers();
}

function renderLibrary(){
  const f = getFilters(); libEl.innerHTML='';
  EX.forEach(e=>{
    if(!f[e.eq]) return;
    if(e.eq==='rings' && !f.rings) return;

    const card = document.createElement('article'); card.className='card';
    const thumb = `https://img.youtube.com/vi/${e.yt}/hqdefault.jpg`;
    card.innerHTML = `
      <h4>${e.n} ${e.badges ? e.badges.map(b=>`<span class="badge">${b}</span>`).join('') : ''}</h4>
      <div class="tile" data-yt="${e.yt}">
        <img class="thumb" src="${thumb}" alt="${e.n} thumbnail" loading="lazy">
        <button class="play" aria-label="Play ${e.n}">
          <svg width="72" height="72" viewBox="0 0 72 72" fill="none" aria-hidden="true">
            <circle cx="36" cy="36" r="34" stroke="white" stroke-opacity=".85" stroke-width="3"/>
            <polygon points="30,24 52,36 30,48" fill="white" />
          </svg>
        </button>
        <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                title="${e.n} form video"></iframe>
        <div class="openers">
          <a href="https://www.youtube.com/watch?v=${e.yt}" target="_blank" rel="noopener">Open on YouTube</a>
          <a href="https://www.youtube.com/results?search_query=${encodeURIComponent(e.n+' exercise form')}" target="_blank" rel="noopener">Search</a>
        </div>
      </div>
      <div class="tags">${e.muscles.map(m=>`<span class="tag">${m.replace(/muscles-/,'').replace(/-/g,' ')}</span>`).join('')}</div>
      ${anatomy(e.muscles)}
    `;
    libEl.appendChild(card);
  });

  // lazy-load on click
  bindTiles(libEl);
}

/* Cross-Training render (with how-to + standards + demo tiles) */
function renderXFit(){
  if(!xfitEl) return;
  xfitEl.innerHTML = '';
  XWODS.forEach(w=>{
    const blk = document.createElement('div'); blk.className='block';
    const rx = w.rx[level] || '';

    const howTo = {
      'amrap-20-5-10-15': `
        <p><strong>How it works:</strong> AMRAP 20 = ‚Äúas many rounds & reps as possible in 20 minutes‚Äù.
        Cycle through pull/row, push-ups, and squats continuously. Keep sets submaximal so your first 5 minutes ‚âà your last 5.</p>`,
      'emom-30-5-10-15': `
        <p><strong>How it works:</strong> EMOM 30 = do the listed reps <em>every minute</em> for 30 minutes.
        Rest in the remaining time. If you can‚Äôt finish a minute, reduce reps by ~20% or switch the rest to AMRAP.</p>`,
      'for-time-50-40-30-20-10-du-situps': `
        <p><strong>How it works:</strong> Complete 50/40/30/20/10 of jump-rope and sit-ups as fast as possible.
        Break rope sets early to stay crisp; keep sit-ups smooth. Suggested time cap: 12‚Äì15 min.</p>`
    }[w.code] || '';

    const standards = `
      <details class="details"><summary>Movement standards, scaling & demos</summary>
        <ul>
          <li><strong>Pull-up / Row (scale):</strong> Full hang to chin-over-bar. Scale to band-assisted or table/door rows at a challenging angle. <em>Faults:</em> short range, loose core, early kip.</li>
          <li><strong>Push-up:</strong> Hands under shoulders, body in one line, chest to target, full lockout. Scale to incline, then knees. <em>Faults:</em> hips sag, elbows flare, half reps.</li>
          <li><strong>Air squat:</strong> Hips below knee crease, heels down, full stand. Scale to box/target or pain-free depth. <em>Faults:</em> knees cave, heels lift.</li>
          <li><strong>Double-/Single-unders:</strong> Tall posture, small fast jumps, wrists turn rope. Scale to single-unders (1:1 or 2:1), penguin taps, or 30‚Äì50 jumping jacks.</li>
          <li><strong>Sit-up:</strong> Shoulders pass hips; choose a consistent ROM/target. Scale to anchored feet, butterfly sit-ups, or crunches.</li>
        </ul>
        <div class="mini-grid">
          ${w.demos.map(d=>demoTileHTML(d.yt, d.title)).join('')}
        </div>
      </details>
    `;

    blk.innerHTML = `
      <h3>${w.title}</h3>
      <p class="meta" style="margin:.2rem 0 .5rem">${w.aka}</p>

      <div class="mov">
        <span class="name">Prescription</span>
        <span class="rx">${applyGoal(rx)}</span>
      </div>

      ${howTo}
      <p class="meta">${w.notes}</p>

      ${standards}
    `;

    blk.insertAdjacentHTML('beforeend', timerHTML('xfit-'+w.code, w.presets.seconds));
    xfitEl.appendChild(blk);
  });

  // bind the newly created demo tiles inside the section
  bindTiles(xfitEl);
  hookTimers();
}

/* ===== Tile binding (play on click, no-cookie embeds) ===== */
function bindTiles(scopeEl){
  scopeEl.querySelectorAll('.tile').forEach(tile=>{
    const id = tile.dataset.yt;
    const btn = tile.querySelector('.play');
    const iframe = tile.querySelector('iframe');
    btn.addEventListener('click', ()=>{
      iframe.src = 'https://www.youtube-nocookie.com/embed/'+id+'?rel=0&modestbranding=1&autoplay=1';
      iframe.style.display='block';
      btn.style.display='none';
    });
  });
}

/* ===== Audible timers (3-beep finish) ===== */
let audioCtx, unlocked=false;
function ensureAudio(){
  if(!audioCtx){ audioCtx = new (window.AudioContext||window.webkitAudioContext)(); }
  if(audioCtx.state==='suspended'){ audioCtx.resume(); }
  unlocked=true;
}
function beepAt(t, freq, dur){
  const o = audioCtx.createOscillator(), g = audioCtx.createGain();
  o.type='sine'; o.frequency.value=freq; g.gain.value=0.0001;
  o.connect(g); g.connect(audioCtx.destination);
  o.start(t); g.gain.exponentialRampToValueAtTime(0.2, t+.01);
  g.gain.exponentialRampToValueAtTime(0.0001, t+dur); o.stop(t+dur+.01);
}
function chime(){
  if(!unlocked) return;
  const now = audioCtx.currentTime;
  beepAt(now+0.00, 880, .15);
  beepAt(now+0.25, 880, .15);
  beepAt(now+0.55, 660, .25);
}
function hookTimers(){
  document.querySelectorAll('[data-timer]').forEach(box=>{
    const input = box.querySelector('input');
    const left  = box.querySelector('.left');
    let t=null, end=0;
    function fmt(s){ return s+'s'; }
    function tick(){
      const remain = Math.max(0, Math.ceil((end - Date.now())/1000));
      left.textContent = fmt(remain);
      if(remain<=0){ clearInterval(t); t=null; chime(); }
    }
    box.querySelector('[data-act="start"]').onclick = ()=>{
      if(!unlocked){ ensureAudio(); }
      const sec = Math.max(5, parseInt(input.value||'60',10));
      left.textContent = fmt(sec); end = Date.now()+sec*1000;
      clearInterval(t); t=setInterval(tick, 200);
    };
    box.querySelector('[data-act="stop"]').onclick = ()=>{
      clearInterval(t); t=null;
      left.textContent = fmt(Math.max(5, parseInt(input.value||'60',10)));
    };
  });
}

/* ===== Boot ===== */
renderPlan(); renderCal(); renderXFit(); renderLibrary();
</script>
</body>
</html>
